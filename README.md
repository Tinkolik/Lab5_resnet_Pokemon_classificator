# Лабораторная работа №4

В прошлой лабораторной работе, после исправления ошибки, у сверточной нейронной сети для классификации изображений покемонов получилась точность классификации = 39.67%.

## Датасет

Датасет состоит из изображений покемонов, разделенных на 150 классов.

Ссылка на датасет: https://www.kaggle.com/datasets/lantian773030/pokemonclassification

4 примера из датасета:

![dataset_preview](/test_preview.png)

## Попробуем увеличить метрики в данной лабораторной работе.

### Аугментация датасета

Проведём следующие аугментации над тренировочной подвыборкой из датасета:

- HorizontalFlip - Горизонтальное отражение изображения с вероятностью 15%;
- ElasticTransform(alpha=1.15, sigma=15, alpha_affine=25) - Эластичное преобразование;
- GaussNoise - Гауссовский шум на все изображения.

4 примера аугментированных изображений:

![dataset_preview](/Augmented_preview.png)

### CSP block

Добавим CSP блок перед каждым слоем пуллинга.

### Параметры модели

- Уменьшим batch_size с 64 до 32;

- Немного уменьшим learning rate со значения 0.001 до 0.0001;

- Увеличим количество эпох обучения с 5 до 10.

## Результаты работы

Классификатор обучился с точностью 49,59%.

**Точность выросла на 10%.**

**Полученные метрики:**

- Accuracy = 0.49586776859504134 
- Precision = 0.5025039018715489 
- Recall = 0.4858432493432493

**Матрица ошибок (Первые 10 классов):**

![dataset_preview](/confusion_10.png)

**Матрица ошибок (Первые 10 классов):**

![dataset_preview](/full_confusion.png)
